<template>
  <div id="doodle">
    <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 331.13 537.58">
      <g id="Layer_1-2" data-name="Layer 1">
        <path
          d="M384,169.89S320.13,179,241,252c0,0-18.38,12.77-33.19,14.3,0,0-22.47,40.85-51.06,47.49,0,0-15.83,258.89,88.34,388.09H485V180.53S430,157.72,384,169.89Z"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M254.77,701.89C149.07,546.15,164.9,320.44,164.9,320.44c33.19-16.34,46.47-43.91,46.47-43.91s21.45-2.55,71.49-48S406.43,180,406.43,180s49.91-2.55,78.57,18.89"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M485,212.7s-83.9-54.39-184.28,12.77c0,0-3.57,3.06-55.66,45.45,0,0-19.34,14.5-29.11,14.3,0,0-24,36.24-41.87,39.32,0,0-6.79,218.23,74.08,343.82a232.26,232.26,0,0,0,26,33.55"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path d="M248.17,668.34c49.57,31.31,97.49-14.45,97.49-14.45s13.28,43.91,107.23,48"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M467.7,406.23c-8.17,60.77-56.18,95.5-114.38,94.47-33-.58-80.66-39-74-99.57,6.64-60.77,53.62-99.57,106.21-99.57S475.82,345.86,467.7,406.23Z"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M462.76,405.52c-7.74,57.65-53.23,90.59-108.38,89.62-31.29-.55-76.43-37-70.16-94.46,6.29-57.65,50.8-94.46,100.64-94.46S470.45,348.24,462.76,405.52Z"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M438.7,404.73c-5.94,42.84-40.86,67.33-83.2,66.61-24-.41-58.67-27.51-53.86-70.21s39-70.21,77.26-70.21S444.6,362.16,438.7,404.73Z"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M408.44,415.54c-14.87,40.33-40.79,58.48-64,51.21-13.17-4.13-25-35.59-10.78-75.95s40.54-61.54,61.69-55.6S423.22,375.48,408.44,415.54Z"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M387.3,409.3c-13,40.31-28.52,61.07-39.24,57.31-6.08-2.13-7.78-30.41,4.87-70.66S381.74,332,391.6,334.78,400.19,369.25,387.3,409.3Z"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M365.15,412.61c-35.41-10.13-54-22.4-51.26-30.95,1.57-4.85,25.94-6.34,61.29,3.53s56.53,22.62,54.57,30.48S400.33,422.68,365.15,412.61Z"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M356.49,444.75c-31.82-9.11-48.54-20.19-46-27.94,1.42-4.4,23.34-5.78,55.1,3.09s50.78,20.38,49,27.51S388.1,453.81,356.49,444.75Z"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M375.75,379.46c-31.82-9.11-45.37-18.07-42.86-25.82,1.42-4.4,20.16-7.9,51.92,1s50.78,20.38,49,27.51S407.37,388.51,375.75,379.46Z"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path
          d="M388.5,350.11c-15.09-3.95-22.92-9.95-21.59-14.93.75-2.82,11.27-4.89,26.33-1.09s24,10,23,14.5S403.49,354,388.5,350.11Z"
          transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path d="M383.19,332s-51.06,3.24-65.62,41.53c0,0-34.8,63.84,29.19,93.84" transform="translate(-154.87 -165.32)"
          fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="2" />
        <path d="M485,486.91" transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10"
          stroke-width="2" />
        <path d="M485,459.85" transform="translate(-154.87 -165.32)" fill="none" stroke="#000" stroke-miterlimit="10"
          stroke-width="2" />
      </g>
    </svg>
  </div>
</template>

<script>
let doodle = {
  name: "Doodle",
  mounted() {
    //set colorScheme
    this.setColorScheme();

    // color scheme change listener
    window
      .matchMedia("(prefers-color-scheme: dark)")
      .addEventListener("change", (event) => {
        this.colorScheme = event.matches ? "dark" : "light";
      });

    this.paths = this.$el.querySelectorAll("path");
    this.paths.forEach((p) => {
      this.setPathStrokeColor(p);
      this.drawPath(p);
    });
  },
  watch: {
    colorScheme() {
      this.paths.forEach((p) => this.setPathStrokeColor(p));
    },
  },
  data() {
    return {
      colorScheme: null,
      paths: [],
    };
  },
  methods: {
    setColorScheme: function () {
      // if (
      //     window.matchMedia &&
      //     window.matchMedia("(prefers-color-scheme: dark)").matches
      // ) {
      // dark mode
      this.colorScheme = "dark";
      // } else {
      //   this.colorScheme = "light";
      // }
    },
    setPathStrokeColor: function (p) {
      p.style.stroke = this.colorScheme === "dark" ? "gold" : "black";
    },
    drawPath: function (path) {
      // Get length of path
      let pathLength = path.getTotalLength();

      // Make very long dashes (the length of the path itself)
      path.style.strokeDasharray = pathLength;

      // Offset the dashes so it appears hidden entirely
      path.style.strokeDashoffset = pathLength;

      // When the page scrolls...
      window.addEventListener("scroll", function (e) {
        // What % down is it?
        let scrollPercentage =
          (document.documentElement.scrollTop + document.body.scrollTop) /
          (document.documentElement.scrollHeight -
            document.documentElement.clientHeight);

        // Length to offset the dashes
        let drawLength = pathLength * scrollPercentage;

        // Draw in reverse
        path.style.strokeDashoffset = pathLength - drawLength;
        //
        // When complete, remove the dash array, otherwise shape isn't quite sharp
        // Accounts for fuzzy math
        if (scrollPercentage >= 0.99) {
          path.style.strokeDasharray = 0;
        } else {
          path.style.strokeDasharray = pathLength;
        }
      });
    },
  },
};

export default doodle;
</script>

<style scoped>
#doodle {
  position: fixed;
  right: 2%;
  top: 10%;
  bottom: 5%;
  margin: auto;
  z-index: -1;
  opacity: 0.125;
}

#doodle svg {
  height: 100%;
  width: auto;
  object-fit: contain;
}

@media (max-width: 992px) {
  #doodle {
    left: 2% !important;
    bottom: 1%;
  }

  #doodle svg {
    width: 120%;
    height: auto;
  }
}
</style>